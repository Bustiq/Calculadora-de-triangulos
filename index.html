<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador Automático de Triángulos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.5rem;
            font-weight: 300;
            color: #2c3e50;
        }
        
        .controles {
            display: flex;
            gap: 30px;
            margin-bottom: 40px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
            padding: 30px;
            background: white;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        
        .grupo-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        label {
            font-weight: 500;
            font-size: 0.95rem;
            color: #495057;
        }
        
        input, button, select {
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s ease;
            border: 1px solid #dee2e6;
        }
        
        input[type="number"] {
            width: 80px;
            padding: 10px;
            text-align: center;
            background: #f8f9fa;
            color: #495057;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #4A90E2;
            background: white;
        }
        
        input[type="range"] {
            width: 150px;
            height: 6px;
            background: #e9ecef;
            border: none;
            outline: none;
            appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: #4A90E2;
            border-radius: 50%;
            cursor: pointer;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #4A90E2;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        
        button {
            padding: 12px 24px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }
        
        button:not(:disabled) {
            background: #4A90E2;
            color: white;
        }
        
        button:not(:disabled):hover {
            background: #357ABD;
            transform: translateY(-1px);
        }
        
        button:disabled {
            background: #adb5bd;
            color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        select {
            padding: 10px 15px;
            background: white;
            color: #495057;
            cursor: pointer;
        }
        
        select:focus {
            outline: none;
            border-color: #4A90E2;
        }
        
        .contenedor-matriz {
            display: flex;
            gap: 30px;
            margin-top: 40px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .seccion-matriz {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .seccion-matriz h3 {
            margin-bottom: 20px;
            font-weight: 500;
            color: #495057;
        }
        
        .matriz-container {
            position: relative;
            display: inline-block;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .matriz {
            position: relative;
            z-index: 2;
        }
        
        .fila {
            display: flex;
            flex-direction: row;
            gap: 3px;
            margin-bottom: 3px;
        }
        
        .fila:last-child {
            margin-bottom: 0;
        }
        
        .celda {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .punto {
            width: 20px;
            height: 20px;
            border: 3px solid #4A90E2;
            border-radius: 50%;
            background: #4A90E2;
            transition: all 0.3s ease;
            position: relative;
            z-index: 3;
        }
        
        .punto.vertice-triangulo {
            border-color: #E74C3C !important;
            background: #E74C3C !important;
            animation: pulso 1s infinite;
            transform: scale(1.2);
            z-index: 10;
        }
        
        @keyframes pulso {
            0%, 100% { 
                background: #E74C3C;
                border-color: #E74C3C;
            }
            50% { 
                background: #C0392B;
                border-color: #C0392B;
            }
        }
        
        .svg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .triangulo-line {
            stroke-width: 3;
            fill: none;
        }
        
        .triangulo-valido {
            stroke: #28A745;
        }
        
        .triangulo-invalido {
            stroke: #E74C3C;
        }
        
        .resultados {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .resultados h3 {
            margin-bottom: 25px;
            font-weight: 500;
            color: #495057;
        }
        
        .estadisticas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .item-estadistica {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .numero-estadistica {
            font-size: 2.2rem;
            font-weight: 600;
            color: #4A90E2;
            display: block;
            margin-bottom: 5px;
        }
        
        .item-estadistica {
            font-size: 0.95rem;
            color: #6c757d;
            font-weight: 500;
        }
        
        .contenedor-progreso {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid #e9ecef;
        }
        
        .contenedor-progreso h3 {
            margin-bottom: 20px;
            font-weight: 500;
            color: #495057;
        }
        
        .barra-progreso {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .relleno-progreso {
            height: 100%;
            background: #28A745;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .triangulo-actual {
            font-size: 1.1rem;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            color: #495057;
            border: 1px solid #e9ecef;
        }
        
        .mostrar-velocidad {
            color: #4A90E2;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .informacion {
            margin-top: 40px;
            padding: 30px;
            background: white;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.7;
            border: 1px solid #e9ecef;
        }
        
        .informacion h4 {
            margin-bottom: 15px;
            color: #495057;
            font-weight: 500;
        }
        
        .informacion p {
            margin-bottom: 12px;
            color: #6c757d;
        }
        
        .informacion strong {
            color: #495057;
            font-weight: 600;
        }
        
        #textoProgreso {
            color: #6c757d;
            font-size: 0.95rem;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .controles {
                gap: 20px;
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .celda {
                width: 35px;
                height: 35px;
            }
            
            .punto {
                width: 15px;
                height: 15px;
                border-width: 2px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Buscador Automático de Triángulos</h1>
        
        <div class="controles">
            <div class="grupo-control">
                <label for="tamañoMatriz">Tamaño de Matriz (n×n):</label>
                <input type="number" id="tamañoMatriz" value="4" min="3" max="8">
            </div>
            
            <div class="grupo-control">
                <label for="velocidadAnimacion">Velocidad de Animación:</label>
                <input type="range" id="velocidadAnimacion" min="1" max="10" value="5">
                <span class="mostrar-velocidad" id="mostrarVelocidad">5x</span>
            </div>
            
            <div class="grupo-control">
                <label for="tipoTriangulo">Tipo de Triángulo:</label>
                <select id="tipoTriangulo">
                    <option value="all">Todos los Triángulos</option>
                    <option value="right">Triángulos Rectángulos</option>
                </select>
            </div>
            
            <button onclick="iniciarAnalisis()" id="btnIniciar">Iniciar Análisis</button>
            <button onclick="detenerAnalisis()" id="btnDetener" disabled>Detener</button>
            <button onclick="reiniciarMatriz()" id="btnReiniciar">Reiniciar</button>
        </div>
        
        <div class="contenedor-matriz">
            <div class="seccion-matriz">
                <h3>Puntos de la Matriz (Todos los puntos considerados automáticamente)</h3>
                <div class="matriz-container">
                    <div id="matriz" class="matriz"></div>
                    <svg class="svg-overlay" id="svgOverlay"></svg>
                </div>
            </div>

            <div class="resultados" id="resultados">
            <h3>Resultados</h3>
            <div class="estadisticas">
                <div class="item-estadistica">
                    <span class="numero-estadistica" id="totalPuntos">0</span>
                    Total de Puntos
                </div>
                <div class="item-estadistica">
                    <span class="numero-estadistica" id="totalCombinaciones">0</span>
                    Combinaciones Posibles
                </div>
                <div class="item-estadistica">
                    <span class="numero-estadistica" id="triangulosValidos">0</span>
                    Triángulos Válidos
                </div>
                <div class="item-estadistica">
                    <span class="numero-estadistica" id="triangulosFiltrados">0</span>
                    Coinciden con Criterio
                </div>
            </div>
        </div>
        </div>
        
        <div class="contenedor-progreso" id="contenedorProgreso" style="display: none;">
            <h3>Progreso del Análisis</h3>
            <div class="barra-progreso">
                <div class="relleno-progreso" id="rellenoProgreso"></div>
            </div>
            <div class="triangulo-actual" id="trianguloActual">Listo para comenzar...</div>
            <div id="textoProgreso">0 / 0 triángulos analizados</div>
        </div>
        
        
        
        <!--div class="informacion">
            <h4>Cómo funciona:</h4>
            <p><strong>Análisis Automático:</strong> El programa considera automáticamente TODOS los puntos en la matriz n×n como vértices potenciales de triángulos.</p>
            <p><strong>Velocidad de Animación:</strong> Controla qué tan rápido el programa muestra cada combinación posible de triángulos (1x = lento, 10x = rápido).</p>
            <p><strong>Detección de Triángulos:</strong> Para cada combinación de 3 puntos, el programa verifica si forman un triángulo válido y aplica el filtro seleccionado.</p>
            <p><strong>Retroalimentación Visual:</strong> Observa cómo cada triángulo se resalta en tiempo real con animaciones pulsantes rojas en los vértices y líneas verdes para triángulos válidos o rojas para líneas rectas.</p>
        </div-->
    </div>

    <script>
        let n = 4;
        let todosTriangulos = [];
        let triangulosValidos = [];
        let indiceTrianguloActual = 0;
        let intervaloAnimacion = null;
        let estaAnalizando = false;
        
        function generarMatriz() {
            n = parseInt(document.getElementById('tamañoMatriz').value);
            if (n < 3 || n > 8) {
                alert('Por favor ingresa un tamaño de matriz entre 3 y 8');
                return;
            }
            
            renderizarMatriz();
            actualizarEstadisticas();
        }
        
        function renderizarMatriz() {
            const divMatriz = document.getElementById('matriz');
            divMatriz.innerHTML = '';
            
            for (let i = 0; i < n; i++) {
                const fila = document.createElement('div');
                fila.className = 'fila';
                for (let j = 0; j < n; j++) {
                    const celda = document.createElement('div');
                    celda.className = 'celda';
                    celda.id = `celda-${i}-${j}`;
                    
                    const punto = document.createElement('div');
                    punto.className = 'punto';
                    punto.id = `punto-${i}-${j}`;
                    
                    celda.appendChild(punto);
                    fila.appendChild(celda);
                }
                divMatriz.appendChild(fila);
            }
            
            // Actualizar el tamaño del SVG
            const matrizContainer = document.querySelector('.matriz-container');
            const svg = document.getElementById('svgOverlay');
            const rect = matrizContainer.getBoundingClientRect();
            svg.setAttribute('viewBox', `0 0 ${rect.width} ${rect.height}`);
        }
        
        function obtenerTodosPuntos() {
            const puntos = [];
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n; j++) {
                    puntos.push([i, j]);
                }
            }
            return puntos;
        }
        
        function obtenerTodasCombinacionesTriangulos() {
            const puntos = obtenerTodosPuntos();
            const combinaciones = [];
            
            for (let i = 0; i < puntos.length; i++) {
                for (let j = i + 1; j < puntos.length; j++) {
                    for (let k = j + 1; k < puntos.length; k++) {
                        combinaciones.push([puntos[i], puntos[j], puntos[k]]);
                    }
                }
            }
            
            return combinaciones;
        }
        
        function esTrianguloValido(p1, p2, p3) {
            const [x1, y1] = p1;
            const [x2, y2] = p2;
            const [x3, y3] = p3;
            
            const area = Math.abs((x1*(y2-y3) + x2*(y3-y1) + x3*(y1-y2)) / 2);
            return area > 0;
        }
        
        function esTrianguloRectangulo(p1, p2, p3) {
            function distanciaCuadrada(a, b) {
                return (a[0]-b[0])**2 + (a[1]-b[1])**2;
            }
            
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            const lados = [d1, d2, d3].sort((a, b) => a - b);
            return Math.abs(lados[0] + lados[1] - lados[2]) < 0.0001;
        }
        
        
        function filtrarTriangulos(triangulos, tipo) {
            return triangulos.filter(triangulo => {
                const [p1, p2, p3] = triangulo;
                switch (tipo) {
                    case 'all':
                        return true;
                    case 'right':
                        return esTrianguloRectangulo(p1, p2, p3);
                    
                    default:
                        return true;
                }
            });
        }
        
        function obtenerPosicionPunto(fila, col) {
            const punto = document.getElementById(`punto-${fila}-${col}`);
            if (!punto) return null;
            
            const rect = punto.getBoundingClientRect();
            const containerRect = document.querySelector('.matriz-container').getBoundingClientRect();
            
            return {
                x: rect.left - containerRect.left + rect.width / 2,
                y: rect.top - containerRect.top + rect.height / 2
            };
        }
        
        function dibujarTriangulo(triangulo, esValido) {
            const svg = document.getElementById('svgOverlay');
            // Limpiar líneas anteriores
            svg.innerHTML = '';
            
            const [p1, p2, p3] = triangulo;
            const pos1 = obtenerPosicionPunto(p1[0], p1[1]);
            const pos2 = obtenerPosicionPunto(p2[0], p2[1]);
            const pos3 = obtenerPosicionPunto(p3[0], p3[1]);
            
            if (!pos1 || !pos2 || !pos3) return;
            
            const className = esValido ? 'triangulo-valido' : 'triangulo-invalido';
            
            // Crear las tres líneas del triángulo
            const lineas = [
                [pos1, pos2],
                [pos2, pos3],
                [pos3, pos1]
            ];
            
            lineas.forEach(([start, end]) => {
                const linea = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                linea.setAttribute('x1', start.x);
                linea.setAttribute('y1', start.y);
                linea.setAttribute('x2', end.x);
                linea.setAttribute('y2', end.y);
                linea.setAttribute('class', `triangulo-line ${className}`);
                svg.appendChild(linea);
            });
        }
        
        function limpiarTriangulo() {
            const svg = document.getElementById('svgOverlay');
            svg.innerHTML = '';
        }
        
        function resaltarTriangulo(triangulo) {
            // Limpiar resaltados previos
            document.querySelectorAll('.punto').forEach(punto => {
                punto.classList.remove('vertice-triangulo');
            });
            
            // Resaltar triángulo actual
            triangulo.forEach(punto => {
                const [fila, col] = punto;
                const puntoElement = document.getElementById(`punto-${fila}-${col}`);
                if (puntoElement) {
                    puntoElement.classList.add('vertice-triangulo');
                }
            });
        }
        
        function actualizarProgreso() {
            const progreso = (indiceTrianguloActual / todosTriangulos.length) * 100;
            document.getElementById('rellenoProgreso').style.width = progreso + '%';
            document.getElementById('textoProgreso').textContent = 
                `${indiceTrianguloActual} / ${todosTriangulos.length} triángulos analizados`;
            
            if (indiceTrianguloActual < todosTriangulos.length) {
                const triangulo = todosTriangulos[indiceTrianguloActual];
                const [p1, p2, p3] = triangulo;
                document.getElementById('trianguloActual').textContent = 
                    `Analizando: (${p1[0]},${p1[1]}) - (${p2[0]},${p2[1]}) - (${p3[0]},${p3[1]})`;
            }
        }
        
        function actualizarEstadisticas() {
            const puntos = obtenerTodosPuntos();
            const totalCombinaciones = (puntos.length * (puntos.length - 1) * (puntos.length - 2)) / 6;
            
            document.getElementById('totalPuntos').textContent = puntos.length;
            document.getElementById('totalCombinaciones').textContent = totalCombinaciones;
            document.getElementById('triangulosValidos').textContent = triangulosValidos.length;
            
            const tipoTriangulo = document.getElementById('tipoTriangulo').value;
            const filtrados = filtrarTriangulos(triangulosValidos, tipoTriangulo);
            document.getElementById('triangulosFiltrados').textContent = filtrados.length;
        }
        
        function iniciarAnalisis() {
            if (estaAnalizando) return;
            
            estaAnalizando = true;
            document.getElementById('btnIniciar').disabled = true;
            document.getElementById('btnDetener').disabled = false;
            document.getElementById('contenedorProgreso').style.display = 'block';
            
            todosTriangulos = obtenerTodasCombinacionesTriangulos();
            triangulosValidos = [];
            indiceTrianguloActual = 0;
            
            const velocidad = parseInt(document.getElementById('velocidadAnimacion').value);
            const retraso = Math.max(50, 1000 / velocidad);
            
            intervaloAnimacion = setInterval(() => {
                if (indiceTrianguloActual >= todosTriangulos.length) {
                    detenerAnalisis();
                    return;
                }
                
                const triangulo = todosTriangulos[indiceTrianguloActual];
                const esValido = esTrianguloValido(...triangulo);
                
                resaltarTriangulo(triangulo);
                dibujarTriangulo(triangulo, esValido);
                
                if (esValido) {
                    triangulosValidos.push(triangulo);
                }
                
                actualizarProgreso();
                actualizarEstadisticas();
                indiceTrianguloActual++;
            }, retraso);
        }
        
        function detenerAnalisis() {
            estaAnalizando = false;
            document.getElementById('btnIniciar').disabled = false;
            document.getElementById('btnDetener').disabled = true;
            
            if (intervaloAnimacion) {
                clearInterval(intervaloAnimacion);
                intervaloAnimacion = null;
            }
            
            // Limpiar resaltados y líneas
            document.querySelectorAll('.punto').forEach(punto => {
                punto.classList.remove('vertice-triangulo');
            });
            limpiarTriangulo();
            
            document.getElementById('trianguloActual').textContent = 
                `¡Análisis completo! Se encontraron ${triangulosValidos.length} triángulos válidos.`;
            
            actualizarEstadisticas();
        }
        
        function reiniciarMatriz() {
            detenerAnalisis();
            generarMatriz();
            document.getElementById('contenedorProgreso').style.display = 'none';
            todosTriangulos = [];
            triangulosValidos = [];
            indiceTrianguloActual = 0;
        }
        
        // Actualizar mostrar velocidad
        document.getElementById('velocidadAnimacion').addEventListener('input', function() {
            document.getElementById('mostrarVelocidad').textContent = this.value + 'x';
        });
        
        // Inicializar
        generarMatriz();
    </script>
</body>
</html>
