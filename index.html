<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscador Automático de Triángulos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #2c3e50;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.5rem;
            font-weight: 300;
            color: #2c3e50;
        }
        
        .contenido-principal {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 30px;
            margin-top: 40px;
            align-items: start;
        }
        
        .panel-controles {
            background: white;
            padding: 30px;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        
        .panel-controles h3 {
            margin-bottom: 25px;
            font-weight: 500;
            color: #495057;
            text-align: center;
        }
        
        .grupo-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .botones-control {
            display: flex;
            flex-direction: row;
            gap: 10px;
            margin-bottom: 25px;
            justify-content: center;
        }
        
        .botones-control button {
            flex: 1;
            min-width: 0;
            padding: 10px 15px;
        }
        
        /* Estilos para filtros de triángulos */
        .filtros-triangulos {
            margin-bottom: 30px;
        }
        
        .seccion-filtros {
            margin-bottom: 20px;
        }
        
        .seccion-filtros h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: #6c757d;
            margin-bottom: 12px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .botones-filtros {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .boton-filtro {
            padding: 10px 15px;
            border: 2px solid #4A90E2;
            border-radius: 8px;
            background: #4A90E2;
            color: white;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .boton-filtro:hover {
            transform: translateY(-1px);
        }
        
        .boton-filtro.inactivo {
            background: transparent;
            color: #4A90E2;
        }
        
        .boton-filtro.inactivo:hover {
            background: #f8f9fa;
        }
        
        label {
            font-weight: 500;
            font-size: 0.95rem;
            color: #495057;
        }
        
        input, button, select {
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s ease;
            border: 1px solid #dee2e6;
        }
        
        input[type="number"] {
            width: 80px;
            padding: 10px;
            text-align: center;
            background: #f8f9fa;
            color: #495057;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #4A90E2;
            background: white;
        }
        
        input[type="range"] {
            width: 150px;
            height: 6px;
            background: #e9ecef;
            border: none;
            outline: none;
            appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 18px;
            height: 18px;
            background: #4A90E2;
            border-radius: 50%;
            cursor: pointer;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #4A90E2;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
        
        button {
            padding: 12px 24px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease;
        }
        
        button:not(:disabled) {
            background: #4A90E2;
            color: white;
        }
        
        button:not(:disabled):hover {
            background: #357ABD;
            transform: translateY(-1px);
        }
        
        button:disabled {
            background: #adb5bd;
            color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .seccion-matriz {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e9ecef;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        
        .seccion-matriz h3 {
            margin-bottom: 20px;
            font-weight: 500;
            color: #495057;
        }
        
        .panel-resultados {
            background: white;
            padding: 30px;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }
        
        .panel-resultados h3 {
            margin-bottom: 25px;
            font-weight: 500;
            color: #495057;
            text-align: center;
        }
        
        .matriz-container {
            position: relative;
            display: inline-block;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .matriz {
            position: relative;
            z-index: 2;
        }
        
        .fila {
            display: flex;
            flex-direction: row;
            gap: 3px;
            margin-bottom: 3px;
        }
        
        .fila:last-child {
            margin-bottom: 0;
        }
        
        .celda {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .punto {
            width: 12px;
            height: 12px;
            border: 3px solid #4A90E2;
            border-radius: 50%;
            background: #4A90E2;
            transition: all 0.3s ease;
            position: relative;
            z-index: 3;
        }
        
        .punto.vertice-triangulo {
            border-color: #E74C3C !important;
            background: #E74C3C !important;
            animation: pulso 1s infinite;
            transform: scale(1.2);
            z-index: 10;
        }
        
        @keyframes pulso {
            0%, 100% { 
                background: #E74C3C;
                border-color: #E74C3C;
            }
            50% { 
                background: #C0392B;
                border-color: #C0392B;
            }
        }
        
        .svg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .triangulo-line {
            stroke-width: 3;
            fill: none;
        }
        
        .triangulo-valido {
            stroke: #28A745;
        }
        
        .triangulo-invalido {
            stroke: #E74C3C;
        }
        
        .resultados {
            margin-top: 0;
            padding: 0;
            background: transparent;
            border-radius: 0;
            text-align: left;
            border: none;
        }
        
        .estadisticas {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .item-estadistica {
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            text-align: center;
        }

        .separador-estadistica{
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .numero-estadistica {
            font-size: 2.2rem;
            font-weight: 600;
            color: #4A90E2;
            display: block;
            margin-bottom: 5px;
        }
        
        .contenedor-progreso {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            border: 1px solid #e9ecef;
        }
        
        .contenedor-progreso h3 {
            margin-bottom: 20px;
            font-weight: 500;
            color: #495057;
        }
        
        .barra-progreso {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .relleno-progreso {
            height: 100%;
            background: #28A745;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .triangulo-actual {
            font-size: 1.1rem;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            color: #495057;
            border: 1px solid #e9ecef;
        }
        
        .mostrar-velocidad {
            color: #4A90E2;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        #textoProgreso {
            color: #6c757d;
            font-size: 0.95rem;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .contenido-principal {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .panel-controles, .panel-resultados {
                order: 0;
            }
            
            .seccion-matriz {
                order: 1;
            }
            
            .estadisticas {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .separador-estadistica {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
            
            .botones-filtros {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .boton-filtro {
                flex: 1;
                min-width: 120px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .contenido-principal {
                gap: 15px;
            }
            
            .panel-controles, .seccion-matriz, .panel-resultados {
                padding: 20px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .celda {
                width: 35px;
                height: 35px;
            }
            
            .punto {
                width: 15px;
                height: 15px;
                border-width: 2px;
            }
            
            .botones-filtros {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Buscador Automático de Triángulos</h1>
        
        <div class="contenedor-progreso" id="contenedorProgreso">   
            <div class="barra-progreso">
                <div class="relleno-progreso" id="rellenoProgreso"></div>
            </div>
        </div>
        
        <div class="contenido-principal">
            <!-- Panel de Controles (Izquierda) -->
            <div class="panel-controles">
                <h3>Controles</h3>
                
                <div class="botones-control">
                    <button onclick="iniciarAnalisis()" id="btnIniciar">▶</button>
                    <button onclick="detenerAnalisis()" id="btnDetener" disabled>⬜</button>
                    <button onclick="reiniciarMatriz()" id="btnReiniciar">↺</button>
                </div>
                
                <div class="grupo-control">
                    <label for="tamañoMatriz">Tamaño:</label>
                    <input type="number" id="tamañoMatriz" value="4" min="3" max="8">
                </div>
                
                <div class="grupo-control">
                    <label for="velocidadAnimacion">Velocidad:</label>
                    <input type="range" id="velocidadAnimacion" min="1" max="10" value="5">
                    <span class="mostrar-velocidad" id="mostrarVelocidad">5x</span>
                </div>
                
                <!-- Filtros de triángulos -->
                <div class="filtros-triangulos">
                    <div class="seccion-filtros">
                        <h4>Por Lados</h4>
                        <div class="botones-filtros">
                            <button class="boton-filtro" data-tipo="isosceles">Isósceles</button>
                            <button class="boton-filtro" data-tipo="escaleno">Escaleno</button>
                        </div>
                        <div style="font-size: 0.8rem; color: #6c757d; text-align: center; margin-top: 10px; padding: 8px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                            <em>Es imposible que se formen triángulos equiláteros</em>
                        </div>
                    </div>
                    
                    <div class="seccion-filtros">
                        <h4>Por Ángulos</h4>
                        <div class="botones-filtros">
                            <button class="boton-filtro" data-tipo="rectangulo">Rectángulo</button>
                            <button class="boton-filtro" data-tipo="acutangulo">Acutángulo</button>
                            <button class="boton-filtro" data-tipo="obtusangulo">Obtusángulo</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Matriz (Centro) -->
            <div class="seccion-matriz">
                <div class="matriz-container">
                    <div id="matriz" class="matriz"></div>
                    <svg class="svg-overlay" id="svgOverlay"></svg>
                </div>
            </div>
            
            <!-- Panel de Resultados (Derecha) -->
            <div class="panel-resultados">
                <div class="resultados" id="resultados">
                    <h3>Resultados</h3>
                    <div class="estadisticas">
                        <div class="separador-estadistica">
                            <div class="item-estadistica">
                                <span class="numero-estadistica" id="totalCombinaciones">0</span>
                                Combinaciones Posibles
                            </div>
                            <div class="item-estadistica">
                                <span class="numero-estadistica" id="triangulosValidos">0</span>
                                Triángulos Válidos
                            </div>
                            <div class="item-estadistica">
                                <span class="numero-estadistica" id="triangulosFiltrados">0</span>
                                Coinciden con Filtros
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let n = 4;
        let todosTriangulos = [];
        let triangulosValidos = [];
        let indiceTrianguloActual = 0;
        let intervaloAnimacion = null;
        let estaAnalizando = false;
        
        // Estado de los filtros (todos activos por defecto)
        let filtrosActivos = {
            equilatero: true,
            escaleno: true,
            rectangulo: true,
            acutangulo: true,
            obtusangulo: true
        };
        
        function generarMatriz() {
            n = parseInt(document.getElementById('tamañoMatriz').value);
            if (n < 3 || n > 8) {
                alert('Por favor ingresa un tamaño de matriz entre 3 y 8');
                return;
            }
            
            renderizarMatriz();
            actualizarEstadisticas();
        }
        
        function renderizarMatriz() {
            const divMatriz = document.getElementById('matriz');
            divMatriz.innerHTML = '';
            
            for (let i = 0; i < n; i++) {
                const fila = document.createElement('div');
                fila.className = 'fila';
                for (let j = 0; j < n; j++) {
                    const celda = document.createElement('div');
                    celda.className = 'celda';
                    celda.id = `celda-${i}-${j}`;
                    
                    const punto = document.createElement('div');
                    punto.className = 'punto';
                    punto.id = `punto-${i}-${j}`;
                    
                    celda.appendChild(punto);
                    fila.appendChild(celda);
                }
                divMatriz.appendChild(fila);
            }
            
            // Actualizar el tamaño del SVG
            const matrizContainer = document.querySelector('.matriz-container');
            const svg = document.getElementById('svgOverlay');
            const rect = matrizContainer.getBoundingClientRect();
            svg.setAttribute('viewBox', `0 0 ${rect.width} ${rect.height}`);
        }
        
        function obtenerTodosPuntos() {
            const puntos = [];
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n; j++) {
                    puntos.push([i, j]);
                }
            }
            return puntos;
        }
        
        function obtenerTodasCombinacionesTriangulos() {
            const puntos = obtenerTodosPuntos();
            const combinaciones = [];
            
            for (let i = 0; i < puntos.length; i++) {
                for (let j = i + 1; j < puntos.length; j++) {
                    for (let k = j + 1; k < puntos.length; k++) {
                        combinaciones.push([puntos[i], puntos[j], puntos[k]]);
                    }
                }
            }
            
            return combinaciones;
        }
        
        function esTrianguloValido(p1, p2, p3) {
            const [x1, y1] = p1;
            const [x2, y2] = p2;
            const [x3, y3] = p3;
            
            const area = Math.abs((x1*(y2-y3) + x2*(y3-y1) + x3*(y1-y2)) / 2);
            return area > 0;
        }
        
        function distanciaCuadrada(a, b) {
            return (a[0]-b[0])**2 + (a[1]-b[1])**2;
        }
        
        // Clasificación por lados
        function esTrianguloEquilatero(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            return d1 === d2 && d2 === d3;
        }
        
        function esTrianguloIsosceles(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            return (d1 === d2 || d2 === d3 || d3 === d1) && !(d1 === d2 && d2 === d3);
        }
        
        function esTrianguloEscaleno(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            return d1 !== d2 && d2 !== d3 && d3 !== d1;
        }
        
        // Clasificación por ángulos
        function esTrianguloRectangulo(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            const lados = [d1, d2, d3].sort((a, b) => a - b);
            return lados[0] + lados[1] === lados[2];
        }
        
        function esTrianguloAcutangulo(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            const lados = [d1, d2, d3].sort((a, b) => a - b);
            return lados[0] + lados[1] > lados[2];
        }
        
        function esTrianguloObtusangulo(p1, p2, p3) {
            const d1 = distanciaCuadrada(p1, p2);
            const d2 = distanciaCuadrada(p2, p3);
            const d3 = distanciaCuadrada(p3, p1);
            
            const lados = [d1, d2, d3].sort((a, b) => a - b);
            return lados[0] + lados[1] < lados[2];
        }
        
        function clasificarTriangulo(p1, p2, p3) {
            const tipos = [];
            
            // Por lados
            if (esTrianguloEquilatero(p1, p2, p3)) tipos.push('equilatero');
            else if (esTrianguloIsosceles(p1, p2, p3)) tipos.push('isosceles');
            else tipos.push('escaleno');
            
            // Por ángulos
            if (esTrianguloRectangulo(p1, p2, p3)) tipos.push('rectangulo');
            else if (esTrianguloAcutangulo(p1, p2, p3)) tipos.push('acutangulo');
            else tipos.push('obtusangulo');
            
            return tipos;
        }
        
        function cumpleFiltros(triangulo) {
            const tipos = clasificarTriangulo(...triangulo);
            return tipos.some(tipo => filtrosActivos[tipo]);
        }
        
        function obtenerPosicionPunto(fila, col) {
            const punto = document.getElementById(`punto-${fila}-${col}`);
            if (!punto) return null;
            
            const rect = punto.getBoundingClientRect();
            const containerRect = document.querySelector('.matriz-container').getBoundingClientRect();
            
            return {
                x: rect.left - containerRect.left + rect.width / 2,
                y: rect.top - containerRect.top + rect.height / 2
            };
        }
        
        function dibujarTriangulo(triangulo, esValido) {
            const svg = document.getElementById('svgOverlay');
            // Limpiar líneas anteriores
            svg.innerHTML = '';
            
            const [p1, p2, p3] = triangulo;
            const pos1 = obtenerPosicionPunto(p1[0], p1[1]);
            const pos2 = obtenerPosicionPunto(p2[0], p2[1]);
            const pos3 = obtenerPosicionPunto(p3[0], p3[1]);
            
            if (!pos1 || !pos2 || !pos3) return;
            
            const className = esValido ? 'triangulo-valido' : 'triangulo-invalido';
            
            // Crear las tres líneas del triángulo
            const lineas = [
                [pos1, pos2],
                [pos2, pos3],
                [pos3, pos1]
            ];
            
            lineas.forEach(([start, end]) => {
                const linea = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                linea.setAttribute('x1', start.x);
                linea.setAttribute('y1', start.y);
                linea.setAttribute('x2', end.x);
                linea.setAttribute('y2', end.y);
                linea.setAttribute('class', `triangulo-line ${className}`);
                svg.appendChild(linea);
            });
        }
        
        function limpiarTriangulo() {
            const svg = document.getElementById('svgOverlay');
            svg.innerHTML = '';
        }
        
        function resaltarTriangulo(triangulo) {
            // Limpiar resaltados previos
            document.querySelectorAll('.punto').forEach(punto => {
                punto.classList.remove('vertice-triangulo');
            });
            
            // Resaltar triángulo actual
            triangulo.forEach(punto => {
                const [fila, col] = punto;
                const puntoElement = document.getElementById(`punto-${fila}-${col}`);
                if (puntoElement) {
                    puntoElement.classList.add('vertice-triangulo');
                }
            });
        }
        
        function actualizarProgreso() {
            const progreso = (indiceTrianguloActual / todosTriangulos.length) * 100;
            document.getElementById('rellenoProgreso').style.width = progreso + '%';
            
        }
        
        function actualizarEstadisticas() {
            const puntos = obtenerTodosPuntos();
            const totalCombinaciones = (puntos.length * (puntos.length - 1) * (puntos.length - 2)) / 6;
            
            document.getElementById('totalCombinaciones').textContent = totalCombinaciones;
            document.getElementById('triangulosValidos').textContent = triangulosValidos.length;
            
            const filtrados = triangulosValidos.filter(cumpleFiltros);
            document.getElementById('triangulosFiltrados').textContent = filtrados.length;
        }
        
        function iniciarAnalisis() {
            if (estaAnalizando) return;
            
            estaAnalizando = true;
            document.getElementById('btnIniciar').disabled = true;
            document.getElementById('btnDetener').disabled = false;
            
            todosTriangulos = obtenerTodasCombinacionesTriangulos();
            triangulosValidos = [];
            indiceTrianguloActual = 0;
            
            const velocidad = parseInt(document.getElementById('velocidadAnimacion').value);
            const retraso = Math.max(50, 1000 / velocidad);
            
            intervaloAnimacion = setInterval(() => {
                if (indiceTrianguloActual >= todosTriangulos.length) {
                    detenerAnalisis();
                    return;
                }
                
                const triangulo = todosTriangulos[indiceTrianguloActual];
                const esValido = esTrianguloValido(...triangulo);
                
                resaltarTriangulo(triangulo);
                dibujarTriangulo(triangulo, esValido);
                
                if (esValido) {
                    triangulosValidos.push(triangulo);
                }
                
                actualizarProgreso();
                actualizarEstadisticas();
                indiceTrianguloActual++;
            }, retraso);
        }
        
        function detenerAnalisis() {
            estaAnalizando = false;
            document.getElementById('btnIniciar').disabled = false;
            document.getElementById('btnDetener').disabled = true;
            
            if (intervaloAnimacion) {
                clearInterval(intervaloAnimacion);
                intervaloAnimacion = null;
            }
            
            // Limpiar resaltados y líneas
            document.querySelectorAll('.punto').forEach(punto => {
                punto.classList.remove('vertice-triangulo');
            });
            limpiarTriangulo();
            
            actualizarEstadisticas();
        }
        
        function reiniciarMatriz() {
            detenerAnalisis();
            generarMatriz();
            todosTriangulos = [];
            triangulosValidos = [];
            indiceTrianguloActual = 0;
            document.getElementById('trianguloActual').textContent = 'Listo para comenzar...';
            document.getElementById('rellenoProgreso').style.width = '0%';
        }
        
        // Manejo de filtros
        function toggleFiltro(tipo) {
            filtrosActivos[tipo] = !filtrosActivos[tipo];
            const boton = document.querySelector(`[data-tipo="${tipo}"]`);
            boton.classList.toggle('inactivo', !filtrosActivos[tipo]);
            actualizarEstadisticas();
        }
        
        function inicializarFiltros() {
            document.querySelectorAll('.boton-filtro').forEach(boton => {
                const tipo = boton.getAttribute('data-tipo');
                boton.addEventListener('click', () => toggleFiltro(tipo));
                // Todos los filtros empiezan activos
                boton.classList.remove('inactivo');
            });
        }
        
        // Actualizar mostrar velocidad
        document.getElementById('velocidadAnimacion').addEventListener('input', function() {
            document.getElementById('mostrarVelocidad').textContent = this.value + 'x';
        });
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            inicializarFiltros();
            generarMatriz();
        });
        
    </script>
</body>
</html>